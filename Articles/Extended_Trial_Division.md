# Extending trial division to polynomials (for the first time?)

To test if a number N is prime, one can try to divide it by all numbers smaller than it. If no integer exists that can divide N, it is considered a prime. This method is known as ‘trial division’. In this article, trial division is extended to certain quadratic polynomials in two variables, among which the Pythagorean squares f(x, y) = x² + y². 

As you will see, this means that we do not need to check all integers (2, 3, 4, ….) to evaluate if an f(x, y) is prime, but only a few, namely only those that are generated by f(x, y)! For example, to check if 7193 is prime, only 15 numbers need to be checked. 

To the best of my (limited mathematical) knowledge, nobody applied trial division on polynomials and has only been done on the regular list of integers. In this article, I show when and how it is possible to extend it to certain Polynomials. For most other polynomials, this trial division process does not seem to work. Let’s find out why!

## A personal note
I’m not a mathematician. My notation and terminology are probably off. What you will read here is based on my own experimental findings and patterns I discovered while ‘playing around’ with prime numbers quite a long time ago. In short, I discovered multiple new ways to generate prime numbers by using polynomials that are related to Unique Factorization Domains. I give no proof as I don’t know how to do such a thing. The best I could do was to try and intuitively explain the patterns that I have discovered.

I did not find anything similar in literature, which makes my work new and original, I guess. Maybe it is not actually new, as it is quite hard to understand math without much background. But maybe someone who reads this knows?

I hope this has any use to or might inspire someone. Or to put it in the words of Grant Sanderson (also known as 3blue1brown): “Some of the most useful math you’ll ever find, has its origins in someone who is just looking for a good story.”

## Trial division
For regular integers ℤ := {.., -3, -2, -1, 0, 1, 2, 3, …}, one method to determine whether an integer N is prime, is to test whether N is divisible by any number that is smaller than N. If none of these numbers divide N, then N is a prime number. This method of prime generation is called Trial division. The following pseudo code shows the core principle of trial division algorithmically.

    Is N prime?
    * Go through all nᵢ smaller than N:
        * If any nᵢ divides N => no
    * If no nᵢ divides N => yes

## Extending Trial Division
Consider now the subset of integers produced by f(x, y) = x² + xy + 41y² with x and y as whole numbers.

One can construct an algorithm that is remarkably similar to trial division. Except that now we are

* checking all f(xᵢ, yᵢ) to test the primality of f(x, y)

instead of

* checking all nᵢ to test the primality of N.

A pseudocode for this algorithm is shown below. Note the  similarity between the two. There are now 2 ‘loops’ (over x and y) instead of only one (over n), but the core principle stays the same.

    Is f(X, Y) prime?
    * Go through all f(xᵢ, yᵢ) smaller than f(X, Y)
        * If any f(xᵢ, yᵢ) divides f(X, Y) => no
    * If no f(xᵢ, yᵢ) divides f(X, Y) => yes

This means that we do not need to check all integers (2, 3, ….) to evaluate if an f(x, y) is a prime, but only a few, namely only those that are generated by f(x, y). An algorithm can then be written to determine if a pair f(x, y) is prime, by simply checking all possible factors f(xᵢ, yᵢ) up until (the square root of) the number that is investigated f(x, y).

For example, to check if f(11, 13) = 7193 is prime, only 15 numbers need to be checked, namely 41, 43, 47, 53, 61, 71, 83, 97 and the squares 4, 9, 16, 25, 36, 49, 64, 81. Try yourself for any (smaller) (x, y) to observe that this is true!

The actual implementation can be found on github.
* [Github repository](https://github.com/PraetBen/ufd_prime_generators/tree/master/Extended_TrialDivision)
* Demo implementation: [![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/PraetBen/ufd_prime_generators/master?filepath=Extended_Trial_Division%2Fnumerical_implementation_demo.ipynb)
* Interactive article: [![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/PraetBen/ufd_prime_generators/master?filepath=Extended_Trial_Division%2Finteractive_article.ipynb)

The last link allows you to follow along with the article, in a Jupyter notebook which can be opened in the browser, if you are familiar with (python) programming. This allows you to play around and explore the examples.

## Properties of x²+xy+y²
Consider now the small subset of integers generated by the following function in more detail.

![](images/Extended_Trial_Division/image001.jpg?raw=true)

![](images/Extended_Trial_Division/image002.jpg?raw=true)

For the remainder of the text, the shorthand notation (x, y) is used for f(x, y). Each pair (x, y) corresponds then to a value in the set of integers. Some examples are given here below, which will be used later on in the text.

![](images/Extended_Trial_Division/image003.jpg?raw=true)

![](images/Extended_Trial_Division/image004.jpg?raw=true)

![](images/Extended_Trial_Division/image005.jpg?raw=true)

![](images/Extended_Trial_Division/image006.jpg?raw=true)

For any (x, y) in the polynomial defined above, the following interesting properties can be observed.

**Observation 1:** Any pair (x, y) where the resulting value N is not a prime in ℤ, can thus be factored by a and b (N = a*b). Similarly, two (xᵢ, yᵢ) can be found, namely (x₁, y₁) and (x₂, y₂) that correspond to this a and this b (in ℤ).

Consider the following example with (11, 12) = 6157, which can be factored into 47 and 131. For both 47 and 131 respectively, a corresponding pair (x, y) can be found.

![](images/Extended_Trial_Division/image007.jpg?raw=true)

![](images/Extended_Trial_Division/image008.jpg?raw=true)
 
![](images/Extended_Trial_Division/image009.jpg?raw=true) 

 

The resulting factors (xᵢ, yᵢ) in the previous example, namely (2, 1) and (9, 1) correspond to the same factors in ℤ, 47 and 131 respectively. This is in general valid for all pairs (x, y) that are not prime (= composite).

**Observation 2:** For any (x, y) where the resulting value N is a prime in ℤ, one cannot find an (xᵢ, yᵢ) that divides N.

Consider for example (11, 13) = 7193, for which no factors can be found. Additionally, no (x₁, y₁) and (x₂, y₂)  can be found such that (11, 13) = (x₁, y₁) (x₂, y₂).

![](images/Extended_Trial_Division/image010.jpg?raw=true)

![](images/Extended_Trial_Division/image011.jpg?raw=true)
 
![](images/Extended_Trial_Division/image012.jpg?raw=true) 

**Conjecture**: Given f(x, y) = x² + xy + 41y². An (x, y) = N is a prime number in ℤ, if and only if, one cannot find any f(xᵢ, yᵢ) that can divide it. This means that when it is not possible to find an f(xᵢ, yᵢ) that divides f(x, y), N is a prime in ℤ.

    (x, y): No factorization possible by (xᵢ, yᵢ) => No factorization possible in ℤ (and thus a prime)

For any polynomial for which this statement is true, extended trial division works. Whenever this is not true, extended trial division will not work correctly. The question is, for what functions f(x, y) will this work? An example will first be given where it doesn’t work and then by a more theoretical explanation of the conditions for which it does work.

## Does this also work with other functions?
This article started with the choice of the function f(x, y) = x²+xy+41y². One could ask now if the previous algorithm would still work if one would use 61 instead of 41? After all, 61 is also a prime number, just like 41. In this section, the subset generated by f(x, y) = x² + xy + 61y² is examined.

![](images/Extended_Trial_Division/image013.jpg?raw=true) 

![](images/Extended_Trial_Division/image014.jpg?raw=true) 

By just taking a glance at the generated numbers, the answer is obviously no. Even in a small subset, there seem to be a lot of non-prime numbers present. What is going on?

One could still use the trial division method to factorize (x, y). However, the conjecture, “when (x, y) cannot be divided by any (xᵢ, yᵢ), it implies that f(x, y) is a prime in ℤ”, is not valid anymore.

**Observation**: For some (and not all!) pairs (x, y) = N which are not prime in ℤ, (x, y) can be factored in two other pairs (xᵢ, yᵢ). For some others, even if N is not a prime in ℤ, no (xᵢ, yᵢ) can be found that divide (x, y).

For example, consider (5, 1) = 91. This is clearly not a prime number, as 91 can be factored into 7 and 13. However, no (xᵢ, yᵢ) pair can be found that corresponds to 7 or 13, nor can one find any (xᵢ, yᵢ) that can divide (5,1). This illustrates that even if (x, y) cannot be divided by any (xᵢ, yᵢ), does not automatically mean that it is a prime.

![](images/Extended_Trial_Division/image015.jpg?raw=true) 

![](images/Extended_Trial_Division/image016.jpg?raw=true) 

![](images/Extended_Trial_Division/image017.jpg?raw=true) 

One can still find examples of (x, y) that can be both factored by a (xᵢ, yᵢ) and ‘regular’ integers. For example, consider (81, 7) = 10117, which is not a prime number.

![](images/Extended_Trial_Division/image018.jpg?raw=true) 

![](images/Extended_Trial_Division/image019.jpg?raw=true) 

![](images/Extended_Trial_Division/image020.jpg?raw=true) 

Whenever there is no (xᵢ, yᵢ) that divides (x, y), you cannot make the conclusion anymore that the corresponding value N is a prime number in ℤ. An algorithm like trial division will thus not work with such a polynomial. In short, the next statement is **not** valid anymore for this function (using C = 61):

    (x, y): No factorization possible by (xᵢ, yᵢ) => No factorization possible in ℤ (and thus a prime)

## Why does it work with 41 and not 61?
The key to understanding why the sieving works with 41 and not 61 (or most other numbers), lies in unique factorization domains. In short, 41 is a special type of number (derived from Heegner Numbers) where unique factorization works, whereas for 61, it does not. More specifically Unique factorization holds only for C = 1, 2, 3, 5, 11, 17 and 41. Only for those numbers extended trial division works.

[See this article](Unique_Factorization_Domains.md) for a more detailed explanation. It is not mandatory but helpful if you haven’t read about complex numbers, UFD and Heegner number and if you want to understand all the details.

The general function that is being considered can be written as follows.

![](images/Extended_Trial_Division/image021.jpg?raw=true) 

Using a complex domain, it can be rewritten.

![](images/Extended_Trial_Division/image022.jpg?raw=true)  

![](images/Extended_Trial_Division/image023.jpg?raw=true) 


This can be easily verified by expanding the right-hand side of the equation, using the definitions of α. As C = 41 (or 61), the term under the square root will be negative. ᾱ represents then the complex conjugate of α. It is also helpful to know that:

![](images/Extended_Trial_Division/image024.jpg?raw=true) 


### Non-Unique Factorization
When C=61, there is no unique factorization, and thus Extended Trial division does not work (as was demonstrated above).

In this domain, an integer can be factored in two different ways. Therefore, even if we cannot find any other (xᵢ, yᵢ), there exists the possibility that it is still factorisable in ℤ in a different way. Consider the factorization of 91.

![](images/Extended_Trial_Division/image025.jpg?raw=true) 

In this example, 91 can be written in terms of two factors, 7 and 13, as well as two other factors in the complex domain. However, there is no way to reduce the complex numbers in smaller blocks in this domain. This means that 91 can be factored in two different ways. As the previous example clearly reveals, there are multiple ways to factorize an (x, y). In other words, Unique Factorization does not hold in this subset. (5, 1) cannot be ‘factored’ by any (x, y), but can be factored in ℤ. That is why it doesn’t work.

### Unique Factorization
When C=41, each factor in  must have a corresponding factor in the complex domain as there is unique factorization. This is the reason that extending Trial division works.

For example, consider the factorization of 6157 = (11, 12). At first sight, it seems to be factored in two different ways:


![](images/Extended_Trial_Division/image008.jpg?raw=true) 

![](images/Extended_Trial_Division/image026.jpg?raw=true) 

However, considering that :

![](images/Extended_Trial_Division/image027.jpg?raw=true) 

![](images/Extended_Trial_Division/image028.jpg?raw=true) 

![](images/Extended_Trial_Division/image029.jpg?raw=true) 

![](images/Extended_Trial_Division/image030.jpg?raw=true) 


We can see that both can be reduced to consist of the same ‘smallest’ blocks.

![](images/Extended_Trial_Division/image031.jpg?raw=true) 

An integer can be factored in only a unique way. Therefore, if we cannot find any (xᵢ, yᵢ) that divides f(x, y), it must mean that it is also not factorizable in ℤ in a different way, and thus prime.


More generally, we can see that in the complex domain, any f(x, y) can be factored into two complex integers (x+yα) and (x+yᾱ). Thus, it is always reducible in the complex domain. In the case when N is prime in ℤ, N cannot be factored. In the complex domain, factorization is still possible, but its terms cannot be made ‘smaller’ and there is no ‘real’ equivalent for the complex number. 

![](images/Extended_Trial_Division/image032.jpg?raw=true) 

In the case when N is composite in ℤ, it has two factors, a and b, which must have an equivalent in the (x, y) form, as Unique factorization must hold. Factoring N first into a and b, and then finding the complex corresponding (x, y) leads to a factorization.

![](images/Extended_Trial_Division/image033.jpg?raw=true) 


Expanding N first into the (x, y) form and then finding its factors will lead to the same terms, as Unique factorization must hold.

![](images/Extended_Trial_Division/image034.jpg?raw=true) 

![](images/Extended_Trial_Division/image035.jpg?raw=true) 




## Conclusion
Personally, the question that remains is, if it is new, or if this has any value for mathematics. Please let me know your thoughts on all of this. 

For example, I wonder if this extended trial division would work with polynomials that are related to class number 1. The working of the sieve is based on Unique Factorization, so maybe other polynomials could also be working like this.

It is possible to do even more than trial division with this special type of polynomials. When filling in y = 1, also the sieve of Eratosthenes can be extended! This makes me wonder, which other methods, now used on regular integers, could we apply on those polynomials to generate prime numbers?

Ben Praet

21/08/2021
 